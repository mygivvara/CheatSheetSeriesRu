# Шпаргалка по управлению устаревшими приложениями

## Введение

Устаревшие приложения — это приложения, которые признаны устаревшими, но продолжают активно использоваться организацией. Это может произойти, если подходящей альтернативы приложению нет, замена в данный момент слишком дорога или приложение имеет высокую степень кастомизации и выполняет очень специфическую роль в цифровой экосистеме организации. Устаревшие приложения часто представляют собой значительный риск для безопасности организации по следующим причинам:

- Устаревшие приложения могли достичь конца жизненного цикла (EoL), что означает, что приложение больше не получает обновлений безопасности или поддержки от поставщика. Это значительно увеличивает риск того, что уязвимости в приложении останутся в эксплуатируемом состоянии.
- Некоторые приложения были созданы с использованием технологий, которые больше не используются или не преподаются техническому персоналу. Это может означать, что знания, необходимые для устранения неисправностей или исправления уязвимостей при их возникновении, могут отсутствовать.
- Устаревшие приложения могут генерировать данные в нестандартных форматах и/или использовать старые интерфейсы или сетевые протоколы. Это может затруднить использование данных, произведенных приложением, с сервисами для управления уязвимостями или безопасности, такими как SIEM (управление безопасностью информации и событий).

Так как не существует универсального подхода к обеспечению безопасности устаревших приложений, эта шпаргалка предназначена для того, чтобы служить ресурсом с практическими рекомендациями по усилению безопасности устаревших приложений, когда альтернативы их использованию не существуют. Предпочтительный подход будет зависеть от таких факторов, как тип данных, хранящихся и производимых устаревшим приложением, наличие известных уязвимостей в приложении и сопутствующей инфраструктуре, а также от того, насколько возможно ограничить доступ к устаревшему приложению или его более рискованным компонентам. Может потребоваться привлечение специалистов в области безопасности (внутренних или внешних), которые смогут предоставить конкретные и контекстуализированные рекомендации.

## Управление инвентаризацией и активами

Для начала организации должны четко понимать, какие устаревшие приложения в настоящее время используются и каковы предполагаемые риски использования этих устаревших решений.

**Управление инвентаризацией:** Начните с составления документации, идентифицирующей устаревшие приложения, используемые вашей организацией, включая номера версий, дату производства и соответствующие настройки конфигурации. В идеале, это должно включать детали о том, на каких сетевых хостах нужно располагаться для доступа к приложению и связанной инфраструктуре. Также следует составить список сервисов, работающих на инфраструктуре, используемой для размещения приложения и/или хранения данных. В некоторых случаях документация может содержать информацию о физическом расположении серверов и разрешенном доступе к ним. Организации могут выбрать создание официального SBOM (список компонентов программного обеспечения) как часть этого процесса. SBOMs играют полезную роль, когда приложение зависит от сторонних компонентов для своей работы.

**Оценка рисков и моделирование угроз:** Убедитесь, что ваша организация четко понимает уровень риска и виды угроз, которые теоретически могут возникнуть при использовании устаревшего приложения и его конкретных компонентов (например, конкретные API маршруты или открытые порты на инфраструктуре хостинга). Это может быть основано на формальном или неформальном моделировании угроз приложения, как описано в [шпаргалке по моделированию угроз](https://example.com/Threat_Modeling_Cheat_Sheet.md). Оценка рисков, связанных с устаревшим программным обеспечением, также может быть облегчена с использованием стандартной отраслевой рамки оценки рисков, такой как [Рамка управления рисками NIST](https://csrc.nist.gov/Projects/risk-management). Существует множество рамок и инструментов для моделирования угроз и оценки рисков, каждый из которых имеет свои сильные и слабые стороны.

В качестве менее формального индикатора того, насколько консервативные меры безопасности следует применять для защиты приложения, рассмотрите следующие вопросы. Они могут помочь контекстуализировать профиль рисков конкретного устаревшего приложения или его компонентов:

- Какие данные обрабатываются/хранятся приложением? Если эти данные будут скомпрометированы, как это повлияет на ваш бизнес и потенциально на требования к соблюдению норм и регуляторных требований?
- Имеют ли приложение/зависимости приложения/инфраструктура, используемая для поддержки приложения, известные уязвимости? Если да, насколько легко их эксплуатировать? Можно ли их исправить с помощью необходимых ресурсов, включая квалифицированных специалистов?
- Насколько критична доступность устаревшего приложения для обеспечения бесперебойной работы вашего бизнеса?
- Если злоумышленник получит доступ к этому приложению, существует ли риск, что он сможет использовать его для утечки другой критически важной информации из вашей организации? Может ли злоумышленник получить доступ к особенно привилегированной сети или среде, компрометировав устаревшее приложение?

## Аутентификация/Авторизация

Меры авторизации обеспечивают правила относительно того, кто может получить доступ к определенному ресурсу и как они могут установить доступ к этому ресурсу. Вопросы авторизации рассмотрены в значительной глубине в [шпаргалке по авторизации](https://example.com/Authorization_Cheat_Sheet.md).

Когда речь идет о применении мер авторизации к устаревшим системам, организации должны рассматривать приложения как inherently high risk (исходно высокорисковые). Принцип минимальных привилегий (предоставление доступа только в той мере, которая строго необходима для выполнения ролей сотрудников/пользователей/систем и содействия бизнес-операциям) особенно актуален для устаревших приложений. Рассмотрите возможность внедрения следующих мер, если это применимо:

- Примените сетевые средства управления доступом к приложению. Это может включать размещение приложения в ограниченной подсети и/или использование списка разрешенных IP-адресов, чтобы предотвратить взаимодействие с особенно открытыми устаревшими приложениями от произвольных хостов. В некоторых случаях приложение может потребовать работы в изолированной среде.
- Контроль авторизации может быть рассмотрен на более детальном уровне, путем сокращения набора функций, доступных конечным пользователям. Например, может потребоваться отключение некоторых функций с высоким уровнем риска, особенно административных функций.
- Убедитесь, что только аутентифицированные пользователи могут получить доступ к приложению. Это может быть обеспечено самим приложением или с помощью службы IdP (поставщика удостоверений). Если приложение размещено в ограниченной сетевой среде, также должна быть обязательна аутентификация для доступа к этой сетевой среде (например, пользователи могут быть обязаны аутентифицироваться на VPN-сервере перед доступом к приложению). Внедрение одной или нескольких из этих мер замедлит злоумышленника и поможет в расследованиях, если произойдет инцидент. См. [шпаргалку по аутентификации](https://example.com/Authentication_Cheat_Sheet.md) для получения дополнительной информации о мерах аутентификации.
- Закройте любые порты на хостах, используемых для работы приложения, которые не являются строго необходимыми для выполнения только тех задач, которые ваша организация требует от приложения. Доступ к определенным портам также может быть ограничен с помощью правил межсетевого экрана/файервола приложений для блокировки серверной инфраструктуры.
- В некоторых случаях может быть возможно ограничить почти всех пользователей от прямого доступа к устаревшему приложению, разработав промежуточный сервис (например, отдельный набор API), который обрабатывает необходимое перемещение данных в и из устаревшего приложения без необходимости взаимодействия конечных пользователей непосредственно с устаревшим приложением.

## Управление уязвимостями

**Сканирование уязвимостей:** Устаревшие приложения должны подвергаться регулярному сканированию на уязвимости с использованием стандартных инструментов оценки уязвимостей, таких как Nessus и Qualys. Это должно происходить на регулярной основе, желательно с автоматическим планированием сканирований через определенные интервалы времени. Где это возможно, некоторые уязвимости могут быть также выявлены с использованием инструментов для сканирования кода, таких как SAST (Статическое тестирование безопасности приложений) для проверки исходного кода на очевидные уязвимости или SCA (Анализ состава программного обеспечения) для выявления уязвимых зависимостей, используемых приложением. В некоторых случаях ни один из вышеперечисленных вариантов может быть жизнеспособен для приложения, и в этом случае прямая оценка конфигурации хоста и ручные проверки кода могут быть единственным подходящим вариантом для оценки безопасности устаревшего приложения.

**Управление патчами:** По возможности применяйте патчи, предоставленные вышеупомянутыми инструментами. Усилия по применению патчей должны быть приоритизированы на основе серьезности уязвимости и наличия опубликованного CVE (Общие уязвимости и экспозиции) и/или общедоступного эксплойта. В случаях, когда применение патчей практически невозможно для устаревшего приложения, рассмотрите возможность применения дополнительных ограничений к приложению/задействованным компонентам, как указано в разделе по аутентификации/авторизации.

## Хранение данных

Убедитесь, что данные, обрабатываемые приложением, по возможности зашифрованы как в покое (т.е. при хранении в базе данных), так и в транзите. Шпаргалки по [Криптографическому хранению](https://example.com/Cryptographic_Storage_Cheat_Sheet.md) и [HTTP Strict Transport Security](https://example.com/HTTP_Strict_Transport_Security_Cheat_Sheet.md) могут предоставить дополнительный контекст. В некоторых случаях устаревшие приложения могут быть ограничены в использовании старых сетевых протоколов, которые поддерживают передачу данных только в открытом виде. В этом случае особенно важно применять максимально строгие сетевые средства управления доступом к приложению. Это может потребовать временной или постоянной изоляции приложения.

## Обеспечение поддерживаемости

По возможности стремитесь поддерживать высокий уровень институциональной экспертизы по приложению, чтобы сотрудники могли как исправлять уязвимости безопасности, так и устранять неполадки приложения по мере необходимости для обеспечения бесперебойной работы бизнеса. Следующие рекомендации применимы:

- Более одного сотрудника должно быть адекватно обучено для устранения неполадок/переконфигурирования устаревшего приложения. Это снизит риск полной утраты возможности технического обслуживания устаревшего приложения, если один из обученных сотрудников покинет организацию.
- Поощряйте сотрудников регулярно документировать процессы, включая запись руководств по устранению неполадок для общих сценариев отказов устаревшего приложения.
- Возможно, потребуется обучить основную группу сотрудников написанию базовых программ на языке, используемом устаревшим приложением, если такая экспертиза отсутствует в вашей организации.

## Управление изменениями

Конечная цель для большинства устаревших приложений заключается в переходе с неудобного для обслуживания решения на решение, которое является как поддерживаемым, так и спроектированным для защиты от современных угроз. Пошаговое управление изменениями может учитывать следующие факторы:

- Какой бюджет можно практически выделить на обновление до современного решения и в какие сроки этот бюджет может быть доступен?
- Существуют ли в вашей организации люди с необходимой экспертизой для выполнения миграции, или таких людей можно привлечь/обучить?
- Насколько срочно требуется миграция на обновленное решение в зависимости от профиля риска приложения и аппетита к рискам вашей организации?

План управления изменениями, формальный или неформальный, должен включать четкое описание конкретных шагов, которые необходимо предпринять для миграции на обновленное решение, явную дату ожидаемого завершения и ясное обоснование бизнес- и безопасности изменений. Для создания реалистичного плана миграции необходимо широко консультироваться с персоналом, занимающимся контролем и использованием существующего решения, чтобы понять, насколько критично устаревшее приложение для вашей организации и какие могут быть препятствия для облегчения миграции или полного списания приложения.

## Непрерывный мониторинг и реагирование на инциденты

Устаревшие приложения должны подвергаться особенно высокому уровню мониторинга безопасности с быстрым реагированием на потенциальные инциденты. Это может быть затруднено проблемами взаимодействия, что означает, что логи, создаваемые приложением, находятся в формате, который не может быть легко интегрирован в инструменты мониторинга безопасности вашей организации. Возможные обходные пути могут включать:

- Разработку пользовательских API для преобразования информации о безопасности из вашего устаревшего приложения и/или его логов в формат, который может быть интегрирован в решения для мониторинга безопасности вашей организации.
- Если вышеупомянутое невозможно, рассмотрите использование автоматизированных скриптов для создания отчетов, оценивающих наличие признаков компрометации.
- Будьте внимательны к аномальному сетевому трафику в и из среды устаревшего приложения и к любым всплескам сетевой активности.
- Если у вас есть доступ к внутренней или нанятой команде реагирования на инциденты, убедитесь, что они знают, что реагирование на инциденты и расследование необычных событий должно иметь приоритет для критически важных устаревших систем. Процессы для обработки простоя приложения и компрометации желательно должны быть задокументированы заранее в рамках плейбука реагирования на инциденты. Это должно предоставить персоналу четкий перечень экстренных процедур, включая контакты для эскалации и детали руководителей по реагированию на инциденты.
- Планирование реагирования на инциденты должно происходить в рамках более широкой бизнес-континуитетной программы.
